import{_ as i}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as a,b as n,o as e}from"./app-_6EpAeW7.js";const t={};function l(h,s){return e(),a("div",null,[...s[0]||(s[0]=[n(`<h1 id="å‰ç«¯å®¹å™¨åŒ–é…ç½®æ³¨å…¥å…¨æ”»ç•¥-docker-k8s-ğŸ³ğŸš€" tabindex="-1"><a class="header-anchor" href="#å‰ç«¯å®¹å™¨åŒ–é…ç½®æ³¨å…¥å…¨æ”»ç•¥-docker-k8s-ğŸ³ğŸš€"><span>å‰ç«¯å®¹å™¨åŒ–é…ç½®æ³¨å…¥å…¨æ”»ç•¥ (Docker/K8s) ğŸ³ğŸš€</span></a></h1><p>å¦‚æœä½ çš„å‰ç«¯åº”ç”¨ç»å¸¸éœ€è¦ä¿®æ”¹é…ç½®ï¼Œæ˜¯å¦æƒ³è¿‡åƒåç«¯ä¸€æ ·é¢„ç•™ä¸€ä¸ªé…ç½®æ–‡ä»¶æ–¹ä¾¿ä¿®æ”¹å°±å¥½äº†ï¼Œä»‹ç»å‡ ç§é…ç½®æ³¨å…¥çš„æ–¹å¼ï¼Œè¿˜æœ‰ K8s çš„ç›¸å…³é…ç½®.</p><p>æœ€è¿‘å’Œä¸€ä¸ªå›¢é˜Ÿåˆä½œï¼Œçœ‹åˆ°ä»–ä»¬å›¢é˜Ÿç”¨äº† Node èµ·äº†ä¸ª BFF å±‚ï¼Œç»“åˆ K8s æä¾›äº†ä¸€äº›é…ç½®ç»™å‰ç«¯ï¼Œç ”ç©¶äº†ä¸€ä¸‹ä¸»æµçš„å‡ ç§æä¾›é…ç½®ç»™å‰ç«¯çš„æ–¹å¼ï¼Œåœ¨å‰ç«¯é¡¹ç›®ä¸­ï¼Œæ— è®ºæ˜¯ Node æœåŠ¡è¿˜æ˜¯ Nginx æ‰˜ç®¡çš„ SPAï¼Œ<strong>ç¯å¢ƒé…ç½®</strong>éƒ½æ˜¯å¿…é¡»é¢å¯¹çš„é—®é¢˜ã€‚è¿™é‡Œæ€»ç»“äº†å‡ ç§ä¸»æµæ–¹å¼ï¼ŒæŠŠé…ç½®æ³¨å…¥åˆ°å‰ç«¯åº”ç”¨ä¸­ï¼Œå¹¶ç»“åˆ <strong>Docker æ„å»º</strong>å’Œ <strong>Kubernetes ConfigMap</strong>ï¼Œæ•´ç†æˆä¸¤å¤§ç±»ï¼š<strong>æ„å»ºæ—¶æ³¨å…¥</strong>å’Œ<strong>è¿è¡Œæ—¶æ³¨å…¥</strong>.</p><hr><h2 id="ä¸€ã€æ„å»ºæ—¶æ³¨å…¥-ğŸ› ï¸" tabindex="-1"><a class="header-anchor" href="#ä¸€ã€æ„å»ºæ—¶æ³¨å…¥-ğŸ› ï¸"><span>ä¸€ã€æ„å»ºæ—¶æ³¨å…¥ ğŸ› ï¸</span></a></h2><p>æ„å»ºæ—¶æ³¨å…¥çš„æ ¸å¿ƒæ€æƒ³æ˜¯ï¼š<strong>é…ç½®åœ¨æ„å»ºé•œåƒæ—¶å°±å·²ç»ç¡®å®š</strong>ã€‚è¿™ç§æ–¹å¼çµæ´»æ€§ç¨å·®ï¼Œä½†å®ç°ç®€å•</p><h3 id="_1-1-ç¯å¢ƒå˜é‡æ³¨å…¥-env-æ–¹å¼" tabindex="-1"><a class="header-anchor" href="#_1-1-ç¯å¢ƒå˜é‡æ³¨å…¥-env-æ–¹å¼"><span>1.1 ç¯å¢ƒå˜é‡æ³¨å…¥ï¼ˆEnv æ–¹å¼ï¼‰</span></a></h3><p>Dockerfile ç¤ºä¾‹ï¼š</p><p>ï¼ˆè¿™é‡Œçº¯å‰ç«¯æ—  Node æœåŠ¡çš„è¯ï¼Œåªéœ€è¦å†™ VITE_MODEï¼Œä¸éœ€è¦å†™ NODE_ENVï¼ŒVite ä¼šæ ¹æ® Vite Mode æ¥æ”¹å˜ NODE_ENVï¼‰</p><div class="language-dockerfile line-numbers-mode" data-highlighter="shiki" data-ext="dockerfile" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-dockerfile"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">FROM</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> node:20-alpine </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">AS</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> build-stage</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">WORKDIR</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> /app</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">COPY</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> . .</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># ä½¿ç”¨ä¸åŒçš„ Vite æ¨¡å¼</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">ARG</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> VITE_MODE=production</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">RUN</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> pnpm run build:\${VITE_MODE}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">CMD</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> [</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;node&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;server/index.js&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">]</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>CI/CD æ„å»ºç¤ºä¾‹ï¼š</p><div class="language-yaml line-numbers-mode" data-highlighter="shiki" data-ext="yaml" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-yaml"><span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">script</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  - </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">|</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    if [ &quot;$BRANCH&quot; == &quot;main&quot; ]; then</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">      VITE_MODE=prod</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    elif [ &quot;$BRANCH&quot; == &quot;staging&quot; ]; then</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">      VITE_MODE=staging</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    else</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">      VITE_MODE=dev</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    fi</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  - </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">docker build --build-arg NODE_ENV=\${NODE_ENV} --build-arg VITE_MODE=\${VITE_MODE} -t myapp:\${VITE_MODE} .</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>ğŸ’¡ è¯´æ˜ï¼šæ„å»ºæ—¶ç¯å¢ƒå˜é‡ç›´æ¥å†™è¿›é•œåƒï¼Œæ— æ³•åœ¨è¿è¡Œæ—¶ä¿®æ”¹</p></blockquote><hr><h3 id="_1-2-æ ‡ç­¾æ³¨å…¥-tag-æ–¹å¼" tabindex="-1"><a class="header-anchor" href="#_1-2-æ ‡ç­¾æ³¨å…¥-tag-æ–¹å¼"><span>1.2 æ ‡ç­¾æ³¨å…¥ï¼ˆTag æ–¹å¼ï¼‰</span></a></h3><p>æœ‰æ—¶æˆ‘ä»¬å¸Œæœ›é•œåƒå¸¦ä¸Šæ„å»ºä¿¡æ¯ï¼Œå¦‚ Git SHA æˆ–åˆ†æ”¯åï¼š</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-shell"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">docker</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> build</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -t</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> myapp:dev-</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">$(</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> rev-parse</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --short</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> HEAD</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">.</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>è¿™æ ·é•œåƒåç§°å°±è‡ªå¸¦ç‰ˆæœ¬ä¿¡æ¯ï¼Œæ–¹ä¾¿éƒ¨ç½²å’Œå›æ»š</p><hr><h3 id="_1-3-html-å†…åµŒé…ç½®-label-æˆ–-script" tabindex="-1"><a class="header-anchor" href="#_1-3-html-å†…åµŒé…ç½®-label-æˆ–-script"><span>1.3 HTML å†…åµŒé…ç½®ï¼ˆ<code>&lt;label&gt;</code> æˆ– <code>&lt;script&gt;</code>ï¼‰</span></a></h3><p>æ„å»ºæ—¶æ³¨å…¥ ï¼Œå¯ä»¥æŠŠé…ç½®ä¿¡æ¯ç›´æ¥å†™å…¥ HTML ä¸­ï¼š</p><div class="language-html line-numbers-mode" data-highlighter="shiki" data-ext="html" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-html"><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">label</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> id</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;STORE_INIT&quot;</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> style</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#98C379;">display:none;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">{</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  &quot;API_URL&quot;: &quot;http://api.example.com&quot;,</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  &quot;APP_NAME&quot;: &quot;TEST_APP&quot;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">label</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å‰ç«¯è¯»å–ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-javascript"><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#986801;--shiki-dark:#E5C07B;"> config</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#986801;--shiki-dark:#E5C07B;"> JSON</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">parse</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;">document</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">getElementById</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;CONFIG_WEB_STORE&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">).</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">innerText</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;">console</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;">config</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#986801;--shiki-dark:#E06C75;">API_URL</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;">config</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#986801;--shiki-dark:#E06C75;">APP_NAME</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>ğŸ¯ ä¼˜ç‚¹ï¼šåˆå§‹åŒ–æ—¶ç›´æ¥å¯ç”¨ï¼Œæ— éœ€é¢å¤–è¯·æ±‚ã€‚<br> âŒ ç¼ºç‚¹ï¼šæ„å»ºåå›ºå®šï¼Œä¸èƒ½åŠ¨æ€ä¿®æ”¹ã€‚</p></blockquote><hr><h2 id="äºŒã€è¿è¡Œæ—¶æ³¨å…¥-âš¡" tabindex="-1"><a class="header-anchor" href="#äºŒã€è¿è¡Œæ—¶æ³¨å…¥-âš¡"><span>äºŒã€è¿è¡Œæ—¶æ³¨å…¥ âš¡</span></a></h2><p>è¿è¡Œæ—¶æ³¨å…¥çš„æ ¸å¿ƒæ€æƒ³æ˜¯ï¼š<strong>é•œåƒä¸åŒ…å«æœ€ç»ˆé…ç½®ï¼Œé…ç½®åœ¨å®¹å™¨è¿è¡Œæˆ– Pod å¯åŠ¨æ—¶æ³¨å…¥</strong>ã€‚</p><h3 id="_2-1-json-é…ç½®æ–‡ä»¶-configmap" tabindex="-1"><a class="header-anchor" href="#_2-1-json-é…ç½®æ–‡ä»¶-configmap"><span>2.1 JSON é…ç½®æ–‡ä»¶ + ConfigMap</span></a></h3><p>å‰ç«¯å¯ä»¥ä» <code>/config/web.config.json</code> è·å–é…ç½®ï¼Œé…åˆ Kubernetes ConfigMapï¼š</p><div class="language-json line-numbers-mode" data-highlighter="shiki" data-ext="json" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-json"><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">{</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">  &quot;API_URL&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;http://api.example.com&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">  &quot;APP_NAME&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;TEST_APP&quot;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Deployment ç¤ºä¾‹ï¼š</p><div class="language-yaml line-numbers-mode" data-highlighter="shiki" data-ext="yaml" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-yaml"><span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">volumeMounts</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  - </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">name</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">frontend-config</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    mountPath</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">/usr/share/nginx/html/config</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">volumes</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  - </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">name</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">frontend-config</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    configMap</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">      name</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">frontend-config</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Node æˆ– Nginx æœåŠ¡éƒ½å¯ä»¥è¯»å– JSON æ–‡ä»¶ï¼Œå‰ç«¯é€šè¿‡ <code>fetch</code> è·å–ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-javascript"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">fetch</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;/config/web.config.json&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  .</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">then</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">res</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> =&gt;</span><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;"> res</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">json</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">())</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  .</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">then</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">cfg</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> =&gt;</span><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;"> console</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">cfg</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">));</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>âœ… ä¼˜ç‚¹ï¼šå¯ä»¥åœ¨è¿è¡Œæ—¶æ›´æ–°é…ç½®ï¼Œæ— éœ€é‡å»ºé•œåƒ</p></blockquote><hr><h3 id="_2-2-node-vs-nginx" tabindex="-1"><a class="header-anchor" href="#_2-2-node-vs-nginx"><span>2.2 Node vs Nginx</span></a></h3><ul><li><strong>Node</strong>ï¼šç›´æ¥è¯»å–æŒ‚è½½çš„ JSON æ–‡ä»¶å³å¯ï¼Œå®¹å™¨å†…ä¿®æ”¹åæ— éœ€é‡å¯æœåŠ¡ï¼ˆå–å†³äºæœåŠ¡å®ç°ï¼‰</li><li><strong>Nginx</strong>ï¼šé™æ€æ–‡ä»¶æœåŠ¡ï¼Œä¿®æ”¹æŒ‚è½½æ–‡ä»¶åï¼Œéœ€è¦é‡å¯ Nginx æˆ–é‡å¯ Pod æ‰èƒ½ç”Ÿæ•ˆ</li></ul><blockquote><p>ğŸ“ å°æŠ€å·§ï¼šJSON æ–‡ä»¶è·¯å¾„å¯é€šè¿‡ Dockerfile çš„ <code>VOLUME</code> æˆ– Kubernetes <code>volumeMounts</code> é¢„ç•™ï¼Œè®© ConfigMap è‡ªåŠ¨è¦†ç›–</p></blockquote><p>å…¶å®ç›´æ¥ç”¨ Nginx æ˜¯æœ€ç¨³å¦¥çš„ï¼ŒBFF å±‚å¾ˆå¤šæ—¶å€™å¹¶æ²¡æœ‰å¿…è¦ï¼Œéƒ½æ˜¯åç«¯çš„èŒèƒ½ï¼Œåç«¯æä¾›äº† VO å°±æ²¡å¿…è¦æŠ˜è…¾äº†ï¼ˆ99% çš„å›¢é˜Ÿæ˜¯ç”¨ä¸ä¸Š BFF çš„ï¼‰ï¼Œå› ä¸ºæˆ‘çœ‹åˆ°å›¢é˜Ÿä¸­çš„ BFF å±‚çš„ä½œç”¨åŸºæœ¬å°±æ˜¯æä¾›äº†æ–‡ä»¶é™æ€æœåŠ¡ï¼Œæä¾›äº†é…ç½®ï¼Œå°±åŠ å…¥äº†ä¸€ä¸ª node åç«¯æ¡†æ¶å’ŒæœåŠ¡ï¼Œå±å®æ— å¿…è¦ï¼Œåè€Œå¢åŠ äº†ç¨‹åºå¤æ‚æ€§ï¼Œå‰ç«¯éœ€è¦å¯åŠ¨ node æœåŠ¡æ‰èƒ½è·‘èµ·æ¥ï¼Œå¦‚æ— å¿…è¦å‹¿å¢å®ä½“ã€‚</p><hr><h2 id="ä¸‰ã€å°ç»“-âœ¨" tabindex="-1"><a class="header-anchor" href="#ä¸‰ã€å°ç»“-âœ¨"><span>ä¸‰ã€å°ç»“ âœ¨</span></a></h2><table><thead><tr><th>ç±»åˆ«</th><th>æ–¹å¼</th><th>æ³¨å…¥æ—¶æœº</th><th>ä¼˜ç¼ºç‚¹</th></tr></thead><tbody><tr><td>æ„å»ºæ—¶æ³¨å…¥</td><td>Env / VITE_MODE</td><td>é•œåƒæ„å»º</td><td>ç®€å•ï¼Œæ— æ³•è¿è¡Œæ—¶ä¿®æ”¹</td></tr><tr><td>æ„å»ºæ—¶æ³¨å…¥</td><td>Tag</td><td>é•œåƒæ„å»º</td><td>é•œåƒå¸¦ç‰ˆæœ¬ä¿¡æ¯ï¼Œæ–¹ä¾¿å›æ»š</td></tr><tr><td>æ„å»ºæ—¶æ³¨å…¥</td><td>HTML <code>&lt;label&gt;</code></td><td>é¡µé¢ç”Ÿæˆ</td><td>åˆå§‹åŒ–ç›´æ¥å¯ç”¨ï¼Œæ„å»ºåå›ºå®š</td></tr><tr><td>è¿è¡Œæ—¶æ³¨å…¥</td><td>JSON + ConfigMap</td><td>å®¹å™¨å¯åŠ¨</td><td>å¯åŠ¨æ€ä¿®æ”¹ï¼Œæ”¯æŒ k8s</td></tr></tbody></table><p>ğŸ’¡ æ€»ç»“ç»éªŒï¼š</p><ul><li><strong>å¼€å‘ç¯å¢ƒ</strong>ï¼šæ„å»ºæ—¶æ³¨å…¥ + æ ‡ç­¾å³å¯å¿«é€Ÿè¿­ä»£</li><li><strong>ç”Ÿäº§ç¯å¢ƒ</strong>ï¼šè¿è¡Œæ—¶æ³¨å…¥ + ConfigMapï¼Œæ›´çµæ´»ï¼Œæ–¹ä¾¿è¿ç»´</li></ul><p>å½“ç„¶ï¼Œè¿˜å¯ä»¥è®©åç«¯æä¾›ä¸€ä¸ªé…ç½®æ¥å£~ è¿™æ˜¯æœ€åŠ¨æ€çš„äº†</p><hr><p><em><strong>END</strong></em></p><hr>`,50)])])}const r=i(t,[["render",l]]),d=JSON.parse('{"path":"/zh/devops/%E5%89%8D%E7%AB%AF%E5%AE%B9%E5%99%A8%E5%8C%96%E9%85%8D%E7%BD%AE%E6%B3%A8%E5%85%A5%E5%85%A8%E6%94%BB%E7%95%A5%20(Docker-K8s)%20%F0%9F%90%B3%F0%9F%9A%80.html","title":"å‰ç«¯å®¹å™¨åŒ–é…ç½®æ³¨å…¥å…¨æ”»ç•¥ (Docker/K8s) ğŸ³ğŸš€","lang":"zh-CN","frontmatter":{"title":"å‰ç«¯å®¹å™¨åŒ–é…ç½®æ³¨å…¥å…¨æ”»ç•¥ (Docker/K8s) ğŸ³ğŸš€","date":"2025-09-28T00:00:00.000Z","categories":["DevOps"],"tags":["Docker","Kubernetes"],"description":"å‰ç«¯å®¹å™¨åŒ–é…ç½®æ³¨å…¥å…¨æ”»ç•¥ (Docker/K8s) ğŸ³ğŸš€ å¦‚æœä½ çš„å‰ç«¯åº”ç”¨ç»å¸¸éœ€è¦ä¿®æ”¹é…ç½®ï¼Œæ˜¯å¦æƒ³è¿‡åƒåç«¯ä¸€æ ·é¢„ç•™ä¸€ä¸ªé…ç½®æ–‡ä»¶æ–¹ä¾¿ä¿®æ”¹å°±å¥½äº†ï¼Œä»‹ç»å‡ ç§é…ç½®æ³¨å…¥çš„æ–¹å¼ï¼Œè¿˜æœ‰ K8s çš„ç›¸å…³é…ç½®. æœ€è¿‘å’Œä¸€ä¸ªå›¢é˜Ÿåˆä½œï¼Œçœ‹åˆ°ä»–ä»¬å›¢é˜Ÿç”¨äº† Node èµ·äº†ä¸ª BFF å±‚ï¼Œç»“åˆ K8s æä¾›äº†ä¸€äº›é…ç½®ç»™å‰ç«¯ï¼Œç ”ç©¶äº†ä¸€ä¸‹ä¸»æµçš„å‡ ç§æä¾›é…ç½®ç»™å‰ç«¯çš„æ–¹å¼ï¼Œåœ¨å‰ç«¯é¡¹ç›®...","head":[["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"å‰ç«¯å®¹å™¨åŒ–é…ç½®æ³¨å…¥å…¨æ”»ç•¥ (Docker/K8s) ğŸ³ğŸš€\\",\\"image\\":[\\"\\"],\\"datePublished\\":\\"2025-09-28T00:00:00.000Z\\",\\"dateModified\\":\\"2026-01-25T08:56:54.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"sharebravery\\",\\"url\\":\\"https://github.com/sharebravery\\"}]}"],["meta",{"property":"og:url","content":"https://sharebravery.github.io/zh/devops/%E5%89%8D%E7%AB%AF%E5%AE%B9%E5%99%A8%E5%8C%96%E9%85%8D%E7%BD%AE%E6%B3%A8%E5%85%A5%E5%85%A8%E6%94%BB%E7%95%A5%20(Docker-K8s)%20%F0%9F%90%B3%F0%9F%9A%80.html"}],["meta",{"property":"og:site_name","content":"sharebravery"}],["meta",{"property":"og:title","content":"å‰ç«¯å®¹å™¨åŒ–é…ç½®æ³¨å…¥å…¨æ”»ç•¥ (Docker/K8s) ğŸ³ğŸš€"}],["meta",{"property":"og:description","content":"å‰ç«¯å®¹å™¨åŒ–é…ç½®æ³¨å…¥å…¨æ”»ç•¥ (Docker/K8s) ğŸ³ğŸš€ å¦‚æœä½ çš„å‰ç«¯åº”ç”¨ç»å¸¸éœ€è¦ä¿®æ”¹é…ç½®ï¼Œæ˜¯å¦æƒ³è¿‡åƒåç«¯ä¸€æ ·é¢„ç•™ä¸€ä¸ªé…ç½®æ–‡ä»¶æ–¹ä¾¿ä¿®æ”¹å°±å¥½äº†ï¼Œä»‹ç»å‡ ç§é…ç½®æ³¨å…¥çš„æ–¹å¼ï¼Œè¿˜æœ‰ K8s çš„ç›¸å…³é…ç½®. æœ€è¿‘å’Œä¸€ä¸ªå›¢é˜Ÿåˆä½œï¼Œçœ‹åˆ°ä»–ä»¬å›¢é˜Ÿç”¨äº† Node èµ·äº†ä¸ª BFF å±‚ï¼Œç»“åˆ K8s æä¾›äº†ä¸€äº›é…ç½®ç»™å‰ç«¯ï¼Œç ”ç©¶äº†ä¸€ä¸‹ä¸»æµçš„å‡ ç§æä¾›é…ç½®ç»™å‰ç«¯çš„æ–¹å¼ï¼Œåœ¨å‰ç«¯é¡¹ç›®..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2026-01-25T08:56:54.000Z"}],["meta",{"property":"article:tag","content":"Kubernetes"}],["meta",{"property":"article:tag","content":"Docker"}],["meta",{"property":"article:published_time","content":"2025-09-28T00:00:00.000Z"}],["meta",{"property":"article:modified_time","content":"2026-01-25T08:56:54.000Z"}]]},"git":{"createdTime":1759051185000,"updatedTime":1769331414000,"contributors":[{"name":"sharebravery","username":"sharebravery","email":"sharebravery@gmail.com","commits":5,"url":"https://github.com/sharebravery"},{"name":"Claude Sonnet 4.5","username":"","email":"noreply@anthropic.com","commits":1}]},"readingTime":{"minutes":3.58,"words":1073},"filePathRelative":"zh/devops/å‰ç«¯å®¹å™¨åŒ–é…ç½®æ³¨å…¥å…¨æ”»ç•¥ (Docker-K8s) ğŸ³ğŸš€.md","excerpt":"\\n<p>å¦‚æœä½ çš„å‰ç«¯åº”ç”¨ç»å¸¸éœ€è¦ä¿®æ”¹é…ç½®ï¼Œæ˜¯å¦æƒ³è¿‡åƒåç«¯ä¸€æ ·é¢„ç•™ä¸€ä¸ªé…ç½®æ–‡ä»¶æ–¹ä¾¿ä¿®æ”¹å°±å¥½äº†ï¼Œä»‹ç»å‡ ç§é…ç½®æ³¨å…¥çš„æ–¹å¼ï¼Œè¿˜æœ‰ K8s çš„ç›¸å…³é…ç½®.</p>\\n<p>æœ€è¿‘å’Œä¸€ä¸ªå›¢é˜Ÿåˆä½œï¼Œçœ‹åˆ°ä»–ä»¬å›¢é˜Ÿç”¨äº† Node èµ·äº†ä¸ª BFF å±‚ï¼Œç»“åˆ K8s æä¾›äº†ä¸€äº›é…ç½®ç»™å‰ç«¯ï¼Œç ”ç©¶äº†ä¸€ä¸‹ä¸»æµçš„å‡ ç§æä¾›é…ç½®ç»™å‰ç«¯çš„æ–¹å¼ï¼Œåœ¨å‰ç«¯é¡¹ç›®ä¸­ï¼Œæ— è®ºæ˜¯ Node æœåŠ¡è¿˜æ˜¯ Nginx æ‰˜ç®¡çš„ SPAï¼Œ<strong>ç¯å¢ƒé…ç½®</strong>éƒ½æ˜¯å¿…é¡»é¢å¯¹çš„é—®é¢˜ã€‚è¿™é‡Œæ€»ç»“äº†å‡ ç§ä¸»æµæ–¹å¼ï¼ŒæŠŠé…ç½®æ³¨å…¥åˆ°å‰ç«¯åº”ç”¨ä¸­ï¼Œå¹¶ç»“åˆ <strong>Docker æ„å»º</strong>å’Œ <strong>Kubernetes ConfigMap</strong>ï¼Œæ•´ç†æˆä¸¤å¤§ç±»ï¼š<strong>æ„å»ºæ—¶æ³¨å…¥</strong>å’Œ<strong>è¿è¡Œæ—¶æ³¨å…¥</strong>.</p>","autoDesc":true}');export{r as comp,d as data};
